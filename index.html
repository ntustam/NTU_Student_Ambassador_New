<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>臺灣大學國際禮賓學生計畫 - 禮賓學生專區</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 固定標題區域 -->
    <header class="subpage-header">
        <a href="index.html" class="logo-link">
            <img src="logo.png" alt="Logo" class="logo">
        </a>
    </header>

    <!-- 學生專區內容 -->
    <div class="subpage">
        <h2>禮賓學生專區</h2>
        <div class="divider"></div> <!-- 分隔線 -->
        <p>請輸入您的電話號碼後三碼以進入任務點數統計表：</p>
        <form id="student-form" onsubmit="return redirectToGoogleSheet()">
            <input type="text" id="student-id" placeholder="輸入電話號碼後三碼" required>
            <button type="submit">確認</button>
        </form>
        <p>*如有問題，請洽詢幹部 
            <a href="https://www.facebook.com/profile.php?id=100013333245748&mibextid=ZbWKwL" style="color: #0078d7; text-decoration: underline;">
                林雨彤
            </a>*
        </p>
    </div>

    <!-- 社群媒體與聯絡方式 -->
    <footer class="footer">
        <div class="footer-content">
            <div class="contact-info">
                <p>地址：106319 臺北市大安區羅斯福路四段1號 禮賢樓7樓</p>
                <p>電話：+886-2-3366-2007, +886-2-2362-6801</p>
            </div>
            <div class="social-icons">
                <a href="https://www.facebook.com/NTUOIASA" target="_blank"><img src="fb-icon.png" alt="Facebook"></a>
                <a href="https://www.instagram.com/ntusa_ambassador/" target="_blank"><img src="ig-icon.png" alt="Instagram"></a>
                <a href="https://oia.ntu.edu.tw/international-guests-scholars/student-ambassador-temp/student-ambassador-new" target="_blank"><img src="web-icon.png" alt="Website"></a>
                <a href="mailto:ntustam@gmail.com" target="_blank"><img src="email_icon.png" alt="email"></a>
            </div>
        </div>
    </footer>

    <script>
        const studentLinks = {};
        
        // 讀取 CSV 並填充到 studentLinks
        async function loadCSV() {
            const response = await fetch('student_links.csv'); // 確保 student_links.csv 在同一目錄中
            const csvText = await response.text();
            const rows = csvText.split('\n');
            
            for (const row of rows) {
                const [studentId, link] = row.split(','); // 逗號分隔
                if (studentId && link) {
                    studentLinks[studentId.trim()] = link.trim();
                }
            }
            
            // 在這裡檢查 studentLinks 的內容
            console.log("Loaded studentLinks:", studentLinks);
        }
        
        // 跳轉到相應的 Google 試算表
        async function redirectToGoogleSheet() {
            const studentId = document.getElementById("student-id").value.trim();
            // 檢查學號是否存在
            if (studentId in studentLinks) {
                const googleSheetURL = studentLinks[studentId];
                alert("即將進入專區");
                window.open(googleSheetURL, "_blank");
            } else {
                alert("找不到該電話號碼的連結，請確認是否正確輸入！");
            }
            return false; // 防止表單提交後重新載入頁面
        }
        
        // 初始化 CSV 加載
        loadCSV();
    </script>
</body>
</html>
